Sub Stock_Challenge()'Define variablesDim ticker As StringDim year_open As DoubleDim year_close As DoubleDim yearly_change As DoubleDim percent_change As DoubleDim total_stock_volume As DoubleDim start_row As IntegerDim previous_row As DoubleDim ws As Worksheet'Start For Loop across all worksheetsFor Each ws In Worksheets    'Assign column Titles    ws.Range("I1").Value = "Ticker"    ws.Range("J1").Value = "Yearly Change"    ws.Range("K1").Value = "Percent Change"    ws.Range("L1").Value = "Total Stock Volume"    'Assign values for variables    start_row = 2    previous_row = 1    total_stock_volume = 0    'Establish last row of column A    last_row = ws.Cells(Rows.Count, "A").End(xlUp).Row        'Add Ticker Symbols to Column "I" and calculate Yearly Change, Percent Change, Total Stock Volume        For i = start_row To last_row            'If Ticker Symbol in Column A changes or is not equal to the previous one, then record value            If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then            'Get the Ticker Symbol            ticker = ws.Cells(i, 1).Value            'Variable to go to the next Ticker            previous_row = previous_row + 1            'Retrieve value for first day open from column 3 and last day close from column 6            year_open = ws.Cells(previous_row, 3).Value            year_close = ws.Cells(i, 6).Value            'Start a nested For Loop to calculate Total Stock Volume from column 7            For j = previous_row To i                total_stock_volume = total_stock_volume + ws.Cells(j, 7).Value            Next j                If year_open = 0 Then                percent_change = year_close                Else                yearly_change = year_close - year_open                percent_change = yearly_change / year_open                End If               'Get the values in the worksheet summary table            ws.Cells(start_row, 9).Value = ticker            ws.Cells(start_row, 10).Value = yearly_change            ws.Cells(start_row, 11).Value = percent_change            'Use percentage format            ws.Cells(start_row, 11).NumberFormat = "0.00%"            ws.Cells(start_row, 12).Value = total_stock_volume            'Update which Row to look at            start_row = start_row + 1            'Reset variables to zero        yearly_change = 0        percent_change = 0        total_stock_volume = 0                    previous_row = i        End If    Next i'Conditional Formatting for 'Yearly Change' Column'Find end row for column JendRow = ws.Cells(Rows.Count, "J").End(xlUp).Row        For y = 2 To endRow            If ws.Cells(y, "J") > 0 Then                ws.Cells(y, "J").Interior.ColorIndex = 4            ElseIf ws.Cells(y, "J") < 0 Then                ws.Cells(y, "J").Interior.ColorIndex = 3            ElseIf ws.Cells(y, "J") = 0 Then            ws.Cells(y, "J").Interior.ColorIndex = 0              End If        Next yNext wsEnd Sub